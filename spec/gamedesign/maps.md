# マップ・ステージ設計

## 舞台: N-KXi
- 西葛西の特徴を捉えているが、西葛西ではない架空の都市
- 西葛西駅が中央にポップし、街が動的生成される

## マップ構造

### グリッドシステム
- 基本サイズ: 30 x 30 セル
- セルサイズ: 1.0 ユニット
- 総面積: 30 x 30 = 900 セル

### 要素配置

#### 西葛西駅 (Station)
- 位置: マップ中央
- サイズ: 1セル
- 機能: 高い人通り、配置不可

#### 道路 (Road)
- パターン: グリッド状
- ブロックサイズ: 5セル
- 道路幅: 1セル
- 配置不可

#### 建物 (Building)
- 配置: ブロック内にランダム
- 密度: 50%
- 機能: 破壊してコンビニを配置可能

#### 空き地 (Empty)
- 配置: 残りのセル
- 機能: 直接コンビニ配置可能

## ステージバリエーション

### Stage 1: 駅前商店街
- サイズ: 20 x 20
- 特徴: 駅周辺に建物が密集
- 難易度: Easy

### Stage 2: 住宅街
- サイズ: 30 x 30
- 特徴: 建物が分散、広いエリア
- 難易度: Normal

### Stage 3: 繁華街
- サイズ: 40 x 40
- 特徴: 複数の駅、複雑な道路
- 難易度: Hard

## 生成アルゴリズム

### BSP (Binary Space Partitioning)
- 空間を再帰的に分割
- 均一なブロック配置

### Voronoi
- 不規則なブロック形状
- より自然な街並み

### Japanese City Generator
- 日本の都市を模した配置
- 駅を中心とした放射状構造

## フェーズ別マップ変化

### Phase 1: 2次元マップ
- トップダウンビュー
- 2Dグリッドベース

### Phase 2: 3次元マップ
- 縦方向にスタック可能
- 最大256階まで積み上げ可能
- 高さによるコスト増加

### Phase 3: 4次元マップ
- 複数次元が存在
- ランダム生成された別次元
- 次元間の相互作用（対消滅）
